---
title: "CIND820 - Big Data Analytics Project"
output: github_document
---
<center> <h1> Initial Results and Code </h1> </center>
<center>  <h3> Dmytro Volynskyy </h2> </center>
<center> <h3> Section D10. Student Number - 501009454 </h2> </center>
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## GitHub Document

This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.

## Read dataset file in R

```{r}
projectData = read.csv("D:\\Study\\CIND820 - Big Data Analytics Project\\Project\\Initial Analysis\\credit_card.csv", header = TRUE,  sep = ",", stringsAsFactors = FALSE)
```

## View the first six rows of the file

```{r}
head(projectData)
```

## Rename class variable

```{r}
colnames(projectData)[colnames(projectData)=="default.payment.next.month"] <- "DEFAULT_PAYMENT"
head(projectData)
```

## Check the structure of the dataframe

```{r}
dim(projectData)
str(projectData)
```

## Install CRAN package 'mlbench' and activate it

```{r}
#install.packages("mlbench")
library(mlbench)
```


## Find distribution of class variable

```{r}
y <- projectData$DEFAULT_PAYMENT
cbind(freq=table(y), percentage=prop.table(table(y))*100)
```

## Viewing the summary of dataset

```{r}
summary(projectData)
```

## Activating libraries of 'DataExplorer' and 'dplyr' packages

```{r}
library(DataExplorer)
library(dplyr)
```

## Find distribution of Education and Mariage variables with not described categories in data description. Assigning those to meaningful ones

```{r}
projectData %>% count(EDUCATION, sort = FALSE)
projectData %>% count(MARRIAGE, sort = FALSE)

projectData$EDUCATION[projectData$EDUCATION == 0] <- 4
projectData$EDUCATION[projectData$EDUCATION == 5] <- 4
projectData$EDUCATION[projectData$EDUCATION == 6] <- 4

projectData$MARRIAGE[projectData$MARRIAGE == 0] <- 3

projectData %>% count(EDUCATION, sort = FALSE)
projectData %>% count(MARRIAGE, sort = FALSE)
```

## Findig correlaction between dataset variables and printing a heat map of those

```{r, echo=FALSE}
correlations <- cor(projectData[,2:25])
print(correlations)


plot_correlation(na.omit(projectData), maxcat = 5L)
```

## Printing histograms of each attribute for univariate analysis

```{r, echo=FALSE}
plot_histogram(projectData)
```


## Removing not needed 'ID' variable and the ones which have very weak correlation with a class variable

```{r}
modelData <- select(projectData, !c('ID', 'BILL_AMT1','BILL_AMT2', 'BILL_AMT3','BILL_AMT4','BILL_AMT5','BILL_AMT6'))
```

## Plot a new heat map of correlations after removing attributes from the dataset

```{r, echo=FALSE}
plot_correlation(na.omit(modelData), maxcat = 5L)
```

## Installing and activating a CRAN package 'imbalance'

```{r}
#install.packages('imbalance')
library(imbalance)
```

## Oversampling of the dataset with new instances of class variable '1' using MWMOTE technique

```{r}
newSamples <- mwmote(modelData, numInstances = 10000, classAttr = "DEFAULT_PAYMENT")
summary(newSamples)
```

## Merge newly created records with an original dataset

```{r}
newData<-rbind(modelData, newSamples)
```

## Shuffle randomly all records in a merged dataset in order not to have variables of one class in each fold of k-fold cross validation

```{r}
set.seed(7)
rows <- sample(nrow(newData))
newDataShuffled <- newData[rows, ]
```

## Plot again a correlation heat map 

```{r, echo=FALSE}
plot_correlation(na.omit(newDataShuffled), maxcat = 5L)
```

## Find class variable distribution in a resulting dataset

```{r}
z <- newData$DEFAULT_PAYMENT
cbind(freq=table(z), percentage=prop.table(table(z))*100)
```






